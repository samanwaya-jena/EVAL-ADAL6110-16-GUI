<?xml version="1.0"?>
<config>
  <layout>
    <!-- default layout at startup.  Tells which windows and parts of
	       screen are displayed. -->
    <display2DWindow>true</display2DWindow>
    <displayTableViewWindow>false</displayTableViewWindow>
    <display3DWindow>false</display3DWindow>
    <displayScopeWindow>false</displayScopeWindow>
    <displayCameraWindow>true</displayCameraWindow>

    <!-- velocity units: display velocity in km/h or m/s
	       0:  Units are in m/s
	       1: Units are in km/h -->
    <velocityUnits>1</velocityUnits>

    <!-- displayed logo: empty string means no logo -->
    <logoFileName>Aerostar-logo.jpg</logoFileName>

    <!-- Name of file containing displayed icon -->
    <iconFileName>AWLQtDemo.ico</iconFileName>
  </layout>

  <debug>
    <enableDebugFile>false</enableDebugFile>
    <enableLogFile>false</enableLogFile>
  </debug>

   <video>
    <displayCrosshair>false</displayCrosshair>
  </video>
  
  <calibration>
    <targetHintDistance>0.0</targetHintDistance>
    <targetHintAngle>0.0</targetHintAngle>
  </calibration>

  <receivers>
    <receiverQty>1</receiverQty>
    <receiver0>
      <!-- The receiverType determines which version of the 
		       Receiver is used in the configuration.
		       This can influence comm port communicationsValid
		       values currently possible are "EasySyncCAN" -->
      <receiverType>EasySyncCAN</receiverType>

      <commPort>COM16</commPort>
      <frameRate>50</frameRate>


      <!-- Channel mask: Controls which channels are
		       processed at AWL Unit Level -->
      <!--This is a bit mask for channels 0 to 7. Enter the mask in decimal -->
      <channelMask>127</channelMask>

      <!-- Message mask flags: 
		       Controls which messages are sent to client unit
		       if msgEnableObstacle is true, all displays will
		       be configured for track mode operation -->
      <msgEnableObstacle>true</msgEnableObstacle>
      <msgEnableDistance_1_4>false</msgEnableDistance_1_4>
      <msgEnableDistance_5_8>false</msgEnableDistance_5_8>
      <msgEnableIntensity_1_4>false</msgEnableIntensity_1_4>
      <msgEnableIntensity_5_8>false</msgEnableIntensity_5_8>

 
      <sensorGeometry>
        <position>
          <!-- positionFromBumper -->
          <forward>0</forward>
          <!-- lateral offet -->
          <left>0.0</left>
          <!-- height -->
          <up>1.3</up>
         </position>
        <orientation>
          <pitch>0.0</pitch>
          <roll>0.0</roll>
          <yaw>0.0</yaw>
        </orientation>
      </sensorGeometry>

      <displayedRangeMin>1.0</displayedRangeMin>
      <displayedRangeMax>45</displayedRangeMax>
      <rangeOffset>-0.75</rangeOffset>

      <channelQty>7</channelQty>
      <channel0>
        <!--channel 0: Short-range left -->
        <fov>
          <x>9.0</x>
          <y>9.0</y>
        </fov>
        <orientation>
          <pitch>6.8</pitch>
          <roll>0.0</roll>
          <yaw>15.0</yaw>
        </orientation>
        <maxRange>20</maxRange>
        <displayColor>
          <red>128</red>
          <green>216</green>
          <blue>168</blue>
        </displayColor>
      </channel0>

      <channel1>
        <!--channel 1: short range - middle left -->
        <fov>
          <x>9.0</x>
          <y>9.0</y>
        </fov>
        <orientation>
          <pitch>6.8</pitch>
          <roll>0.0</roll>
          <yaw>5.0</yaw>
        </orientation>
        <maxRange>20</maxRange>
         <displayColor>
          <red>54</red>
          <green>166</green>
          <blue>38</blue>
        </displayColor>
      </channel1>

      <channel2>
        <!--channel 2: short range - middle right -->
        <fov>
          <x>9.0</x>
          <y>9.0</y>
        </fov>
        <orientation>
          <pitch>6.8</pitch>
          <roll>0.0</roll>
          <yaw>-5.0</yaw>
        </orientation>
        <maxRange>20</maxRange>
        <displayColor>
          <red>54</red>
          <green>166</green>
          <blue>38</blue>
        </displayColor>
      </channel2>

      <channel3>
        <!--channel 3: short range - right -->
        <fov>
          <x>9.0</x>
          <y>9.0</y>
        </fov>
        <orientation>
          <pitch>6.8</pitch>
          <roll>0.0</roll>
          <yaw>-15.0</yaw>
        </orientation>
        <maxRange>20</maxRange>
        <displayColor>
          <red>128</red>
          <green>216</green>
          <blue>168</blue>
        </displayColor>
      </channel3>

      <channel4>
        <!--channel 4: long range - left -->
        <fov>
          <x>4.3</x>
          <y>4.3</y>
        </fov>
        <orientation>
          <pitch>2.15</pitch>
          <roll>0.0</roll>
          <yaw>4.6</yaw>
        </orientation>
        <maxRange>80</maxRange>
        <displayColor>
          <red>172</red>
          <green>192</green>
          <blue>217</blue>
        </displayColor>
      </channel4>

      <channel5>
        <!--channel 5: long range - center -->
        <fov>
          <x>4.3</x>
          <y>4.3</y>
        </fov>
        <orientation>
          <pitch>2.15</pitch>
          <roll>0.0</roll>
          <yaw>0.0</yaw>
        </orientation>
        <maxRange>80</maxRange>
        <displayColor>
          <red>172</red>
          <green>192</green>
          <blue>217</blue>
        </displayColor>
      </channel5>

      <channel6>
        <!--channel 6: long range - right -->
        <fov>
          <x>4.3</x>
          <y>4.3</y>
        </fov>
        <orientation>
          <pitch>2.15</pitch>
          <roll>0.0</roll>
          <yaw>-4.6</yaw>
        </orientation>
        <maxRange>80</maxRange>
        <displayColor>
          <red>172</red>
          <green>192</green>
          <blue>217</blue>
        </displayColor>
      </channel6>
    </receiver0>

  </receivers>

  <cameras>
    <cameraQty>1</cameraQty>
    <camera0>
      <!-- cameraName:
	    Camera index, as used in openCV.
       Indexes start at 0, up to 99. 
       To the index, you a can add a number (multiple of 100) to specify specific OpenCV camera driver handler.
       XIMEA Cameras, add 1100 to the camera index (default XIMEA camera would be "1100").
       A non-numeric camera name can be used to specify a video file.-->
      <cameraName>0</cameraName> <!-- Camera #1 is the computer webcam in a 2 camera setup -->

      <!-- cameraFlip:
       if true, 180 degree rotation of the camera image, 
       for cameras that need to be fixed upside down. -->
      <cameraFlip>true</cameraFlip>

      <position>
        <!-- positionFromBumper -->
        <forward>0</forward>
        <!-- lateral offet -->
        <left>0.0</left>
        <!-- height -->
        <up>1.3</up>
      </position>
      <orientation>
        <pitch>0.0</pitch>
        <roll>0.0</roll>
        <yaw>0.0</yaw>
      </orientation>

      <!-- Comment out unused cameras
		< MS_LIFECAM_CINEMA >
		<fov>
			<x>47.4</x>
			<y>30.6</y>
		</fov>

		< MS_LIFECAM_HD6000 @640x360 >
		<fov>
			<x>45.0</x>
			<y>39.0</y>
		</fov>

		< MS_LIFECAM_HD5000 @640x360 >
			<fov>
			<x>45.0</x>
			<y>39.0</y>
		</fov>
    
     < LOGITECH_C270 @640 x 480 >
    <fov>
      <x>42.0</x>
      <y>27.0</y>
    </fov>

     < XIMEA with 3.6mm lensing >
    <fov>
      <x>96.75</x>
      <y>72.5</y>
     </fov>

    End Comment out unused cameras -->

      <!-- XIMEA with 3.6mm lensing -->
      <fov>
        <x>96.75</x>
        <y>72.5</y>
      </fov>
    </camera0>


    <camera1>
      <!-- cameraName:
	    Camera index, as used in openCV.
       Indexes start at 0, up to 99. 
       To the index, you a can add a number (multiple of 100) to specify specific OpenCV camera driver handler.
       XIMEA Cameras, add 1100 to the camera index.
       An non-numeric camera name can be used to specify a video file.-->
      <cameraName>1100</cameraName> <!-- Camera #1100 is first Ximea in a 2 camera setup -->

      <!-- cameraFlip:
       if true, 180 degree rotation of the camera image, 
       for cameras that need to be fixed upside down. -->
      <cameraFlip>true</cameraFlip>

      <position>
        <!-- positionFromBumper -->
        <forward>0</forward>
        <!-- lateral offet -->
        <left>0.0</left>
        <!-- height -->
        <up>0</up>
      </position>
      <orientation>
        <pitch>0.0</pitch>
        <roll>0.0</roll>
        <yaw>0.0</yaw>
      </orientation>

      <!-- XIMEA with 3.6mm lensing. F1.8 -->
      <fov>
        <x>96.75</x>
        <y>72.5</y>
      </fov>
    </camera1>

  </cameras>
  

  
  <displayTableView>
    <displayedDetectionsPerChannelInTableView>2</displayedDetectionsPerChannelInTableView>
  </displayTableView>

  <display2D>
    <carWidth>1.78</carWidth>
    <!-- Car width in meters -->
    <carLength>4.53</carLength>
    <!-- Car width in meters -->
    <carHeight>1.44</carHeight>
    <!-- Car height in meters -->
    <laneWidth>3.7</laneWidth>
    <!--Lane width in meters -->

    <shortRangeDistance>13.0</shortRangeDistance>
    <shortRangeDistanceStartLimited>13.0</shortRangeDistanceStartLimited>
    <shortRangeAngle>40.0</shortRangeAngle>
    <shortRangeAngleStartLimited>20.0</shortRangeAngleStartLimited>

    <longRangeDistance>30.0</longRangeDistance>
    <longRangeDistanceStartLimited>20.0</longRangeDistanceStartLimited>
    <longRangeAngle>13.0</longRangeAngle>
    <longRangeAngleStartLimited>13.0</longRangeAngleStartLimited>

    <!-- velocity for colorCoding in m/s -->
    <maxVelocity>30.0</maxVelocity>

    <!-- zeroVelocity is velocity at which we consider 
	     a target to be static (-zeroVelocity to +zeroVelocity) -->
    <!-- in m/s -->
    <zeroVelocity>1.0</zeroVelocity>

    <!-- Merge detection Mode
	     0:		eNoMerge - don't merge targets
	     1: 		eRadial - According to radial distance
	     2:		eLongitudinal - According to bumper distance -->
    <mergeDetectionMode>2</mergeDetectionMode>

    <!-- mergeDisplayMode 
	     0: NONE
	     1: Rectangle under detection 
	        (Still display distance individually)
	     2: Rectangle without detection, display only one distance
	     3: Rectangle with detections, but only one distance -->
    <mergeDisplayMode>3</mergeDisplayMode>

    <!-- measureMode
	     0: Radial
	     1: Longitudinal distance from bumper -->
    <measureMode>1</measureMode>

    <!-- colorCode
	     0: Colors indicate distances
	     1: Colors indicate speed -->
    <colorCode>1</colorCode>

    <!-- mergeAcceptance
       distance before we merge targets
       Merge acceptance is in 2D view coordinates, so:
        - X is lateral
        - Y is forward    -->
    <mergeAcceptance>
      <x>3.0</x>
      <y>1.0</y>
    </mergeAcceptance>

    <showPalette>1</showPalette>
    <displayDistances>1</displayDistances>
  </display2D>

  <display3D>   
    <decimation>3</decimation>
    <pixelSize>1</pixelSize>
    <colorStyle>0</colorStyle>
    <cameraView>3</cameraView>
    <viewerDepth>-1.54</viewerDepth>
    <viewerHeight>1.30</viewerHeight>
    <viewerMaxRange>100</viewerMaxRange>
  </display3D>

  <scope>
    <!-- interval in ms -->
    <timerInterval>30</timerInterval>
    <!-- scope window:determine what curves are displayed -->
    <displayScopeDistance>true</displayScopeDistance>
    <displayScopeVelocity>true</displayScopeVelocity>
  </scope>


  <dynamicTesting>
    <!--	Deceleration thresholds for various threat levels, 
	     using the maximum deceleration level threat calculation 
	     algorithm
	     In m/s2 -->
    <threatLevelCriticalThreshold>4.0</threatLevelCriticalThreshold>
    <threatLevelWarnThreshold>3.0</threatLevelWarnThreshold>
    <threatLevelLowThreshold>1.0</threatLevelLowThreshold>

    <!-- Max deceleration of the vehicle with full brakes on
	     Kusano-Gaeble
	     (http://www.sbes.vt.edu/gabler/publications/Kusano-Gabler-SAE-TTC_EDRs-2011-01-0576.pdf)
	     Give estimates of 0.52G (0.52 * 9,8m/s2) or 5,096 m/s2
	     Specify in m/s2 -->
    <brakingDeceleration>5.096</brakingDeceleration>

    <!-- Current speed of vehicle
	     Travel speed is a variable that should be taken from 
	     CAN measurements.
	     In the meantime, we have a variable for that
	     Specify in m/s, use <NN>km/h(60.0 * 1000)/(60*60) -->
    <travelSpeed>16.66</travelSpeed>
  </dynamicTesting>


  <registerDescription_RevC>
    <registersFPGA>
      <register>
        <index>R0</index>
        <address>0</address>
        <description>Version - Date</description>
      </register>

      <register>
        <index>R1</index>
        <address>4</address>
        <description>Underflow - Overflow</description>
      </register>

      <register>
        <index>R3</index>
        <address>12</address>
        <description>MIO Control</description>
      </register>

      <register>
        <index>R4</index>
        <address>16</address>
        <description>ASCAN Timing Register</description>
      </register>

      <register>
        <index>R5</index>
        <address>20</address>
        <description>ASCAN Frequency Register</description>
      </register>

      <register>
        <index>R6</index>
        <address>24</address>
        <description>Debug Mode - Ramp Test - Soft Reset - Input Clock</description>
      </register>

      <register>
        <index>R7</index>
        <address>28</address>
        <description>Dead zone</description>
      </register>

      <register>
        <index>R8</index>
        <address>32</address>
        <description>SYS - LIDAR Module Enable</description>
      </register>

      <register>
        <index>R9</index>
        <address>36</address>
        <description>Pulse Width - Mode - LZ Enable</description>
      </register>

      <register>
        <index>R10</index>
        <address>40</address>
        <description>ACC -  ChannelMask</description>
      </register>

      <register>
        <index>R11</index>
        <address>44</address>
        <description>FIR Tap A</description>
      </register>

      <register>
        <index>R12</index>
        <address>48</address>
        <description>FIR Tap B</description>
      </register>

      <register>
        <index>R13</index>
        <address>52</address>
        <description>DDR Base Address</description>
      </register>

      <register>
        <index>R14</index>
        <address>56</address>
        <description>SR Channel Enable</description>
      </register>

      <register>
        <index>R15</index>
        <address>60</address>
        <description>LR Channel Enable</description>
      </register>

      <register>
        <index>R16</index>
        <address>64</address>
        <description>IRQ Status</description>
      </register>

      <register>
        <index>R17</index>
        <address>68</address>
        <description>IRQ Enable</description>
      </register>

      <register>
        <index>R18</index>
        <address>72</address>
        <description>IRQ Reset</description>
      </register>

      <register>
        <index>R19</index>
        <address>76</address>
        <description>Laser frequency</description>
      </register>

      <register>
        <index>R27</index>
        <address>108</address>
        <description>DDR Input Delay</description>
      </register>

      <register>
        <index>R28</index>
        <address>112</address>
        <description>SERDES Sync."</description>
      </register>

      <register>
        <index>R29</index>
        <address>116</address>
        <description>Tx AXI Error</description>
      </register>

      <register>
        <index>R30</index>
        <address>120</address>
        <description>Debug Mode - Debug LED</description>
      </register>

      <register>
        <index>R31</index>
        <address>124</address>
        <description>Channel Enable</description>
      </register>
    </registersFPGA>

    <registersADC>
      <register>
        <index>0</index>
        <address>0</address>
        <description>Software Reset</description>
      </register>

      <register>
        <index>0x0F</index>
        <address>15</address>
        <description>Power-Down Modes</description>
      </register>

      <register>
        <index>0x11</index>
        <address>17</address>
        <description>LVDS Drive Program</description>
      </register>

      <register>
        <index>¸0x12</index>
        <address>18</address>
        <description>LVDS Internal Termination</description>
      </register>

      <register>
        <index>0x14</index>
        <address>20</address>
        <description>Low-freq noise supression mode</description>
      </register>

      <register>
        <index>0x24</index>
        <address>36</address>
        <description>Analog Input Invert</description>
      </register>

      <register>
        <index>0x25</index>
        <address>37</address>
        <description>LVDS Test Patterns A</description>
      </register>

      <register>
        <index>0x26</index>
        <address>38</address>
        <description>LVDS Test Patterns B</description>
      </register>

      <register>
        <index>0x27</index>
        <address>39</address>
        <description>LVDS Test Patterns C</description>
      </register>

      <register>
        <index>0x45</index>
        <address>69</address>
        <description>LVDS Test Patterns D</description>
      </register>

      <register>
        <index>0x2A</index>
        <address>42</address>
        <description>Programmable Gain A</description>
      </register>

      <register>
        <index>0x2B</index>
        <address>43</address>
        <description>Programmable Gain B</description>
      </register>

      <register>
        <index>0x42</index>
        <address>66</address>
        <description>Clock, Reference, Data out mode A</description>
      </register>

      <register>
        <index>0x46</index>
        <address>70</address>
        <description>Clock, Reference, Data out mode B</description>
      </register>
    </registersADC>

    <GPIOs>
      <register>
        <index>67</index>
        <address>67</address>
        <description>ADC Reset</description>
      </register>

      <register>
        <index>68</index>
        <address>68</address>
        <description>ADC Power down</description>
      </register>

      <register>
        <index>70</index>
        <address>70</address>
        <description>Short-range disable</description>
      </register>

      <register>
        <index>71</index>
        <address>71</address>
        <description>Short-range attenuation</description>
      </register>

      <register>
        <index>72</index>
        <address>72</address>
        <description>Short-range gain</description>
      </register>

      <register>
        <index>73</index>
        <address>73</address>
        <description>Long-range disable</description>
      </register>

      <register>
        <index>74</index>
        <address>74</address>
        <description>Long-range attenuation</description>
      </register>

      <register>
        <index>75</index>
        <address>75</address>
        <description>Long-range gain</description>
      </register>
    </GPIOs>

    <algos>
      <defaultAlgo>4</defaultAlgo>
      <algo>
        <!-- Algo 00 -->
        <!-- Algo00 is the Global parameters section -->
        <algoID>0</algoID>
        <algoName>Global</algoName>
        <parameter>
          <index>17</index>
          <address>17</address>
          <description>Window width</description>
          <type>int</type>
          <default>3</default>
        </parameter>

        <parameter>
          <index>18</index>
          <address>18</address>
          <description>Window qty</description>
          <type>int</type>
          <default>3</default>
        </parameter>

        <parameter>
          <index>1</index>
          <address>1</address>
          <description>Moving average</description>
          <type>int</type>
          <default>0</default>
        </parameter>

        <parameter>
          <index>2</index>
          <address>2</address>
          <description>Persistance</description>
          <type>int</type>
          <default>7</default>
        </parameter>

        <parameter>
          <index>257</index>
          <address>257</address>
          <description>Track filter Alpha</description>
          <type>float</type>
          <default>0.2</default>
        </parameter>

        <parameter>
          <index>258</index>
          <address>258</address>
          <description>Track filter Beta</description>
          <type>float</type>
          <default>0.015</default>
        </parameter>

        <parameter>
          <index>289</index>
          <address>289</address>
          <description>Track max speed</description>
          <type>float</type>
          <default>30.0</default>
        </parameter>
      </algo>

      <algo>
        <!-- Algo 01 -->
        <!-- Algo01 is the threshold algo section -->
        <algoID>1</algoID>
        <algoName>Threshold</algoName>

        <parameter>
          <index>0</index>
          <address>0</address>
          <description>Offset</description>
          <type>int</type>
          <default>0</default>
        </parameter>
      </algo>

      <algo>
        <!-- Algo 02 -->
        <!-- Algo02 is the dw algosection -->
        <algoID>2</algoID>
        <algoName>Double-W</algoName>

        <parameter>
          <index>0</index>
          <address>0</address>
          <description>Offset</description>
          <type>int</type>
          <default>0</default>
        </parameter>

        <parameter>
          <index>1</index>
          <address>1</address>
          <description>Starting threshold</description>
          <type>float</type>
          <default>0.15</default>
        </parameter>

        <parameter>
          <index>2</index>
          <address>2</address>
          <description>First damping</description>
          <type>float</type>
          <default>0.15</default>
        </parameter>

        <parameter>
          <index>3</index>
          <address>3</address>
          <description>Numwidth</description>
          <type>int</type>
          <default>2</default>
        </parameter>

        <parameter>
          <index>4</index>
          <address>4</address>
          <description>Intensity filter</description>
          <type>int</type>
          <default>0</default>
        </parameter>

        <parameter>
          <index>5</index>
          <address>5</address>
          <description>Second width</description>
          <type>int</type>
          <default>6</default>
        </parameter>

        <parameter>
          <index>6</index>
          <address>6</address>
          <description>First index</description>
          <type>int</type>
          <default>0</default>
        </parameter>

        <parameter>
          <index>7</index>
          <address>7</address>
          <description>SNR Cutoff (dB)</description>
          <type>float</type>
          <default>18.0</default>
        </parameter>
      </algo>

      <algo>
        <!-- Algo 03 -->
        <!-- Algo03 is the double-d algo -->
        <algoID>3</algoID>
        <algoName>Double-D</algoName>

        <parameter>
          <index>0</index>
          <address>0</address>
          <description>Offset</description>
          <type>int</type>
          <default>0</default>
        </parameter>

        <parameter>
          <index>1</index>
          <address>1</address>
          <description>Starting threshold</description>
          <type>float</type>
          <default>0.1</default>
        </parameter>

        <parameter>
          <index>2</index>
          <address>2</address>
          <description>First derivate order</description>
          <type>int</type>
          <default>2</default>
        </parameter>

        <parameter>
          <index>3</index>
          <address>3</address>
          <description>Second derivate order</description>
          <type>int</type>
          <default>6</default>
        </parameter>

        <parameter>
          <index>4</index>
          <address>4</address>
          <description>Intensity filter</description>
          <type>int</type>
          <default>0</default>
        </parameter>

        <parameter>
          <index>6</index>
          <address>6</address>
          <description>First index</description>
          <type>int</type>
          <default>0</default>
        </parameter>

        <parameter>
          <index>7</index>
          <address>7</address>
          <description>SNR Cutoff (dB)</description>
          <type>float</type>
          <default>18.0</default>
        </parameter>
      </algo>

      <algo>
        <!-- Algo 04 -->
        <!-- Algo04 is RMSConv -->
        <algoID>4</algoID>
        <algoName>RMSConv</algoName>

        <parameter>
          <index>0</index>
          <address>0</address>
          <description>Offset</description>
          <type>int</type>
          <default>0</default>
        </parameter>

        <parameter>
          <index>2</index>
          <address>2</address>
          <description>Damping</description>
          <type>float</type>
          <default>1.3</default>
        </parameter>

        <parameter>
          <index>3</index>
          <address>3</address>
          <description>Mean width</description>
          <type>int</type>
          <default>3</default>
        </parameter>

        <parameter>
          <index>4</index>
          <address>4</address>
          <description>SourceWidth</description>
          <type>int</type>
          <default>7</default>
        </parameter>

        <parameter>
          <index>5</index>
          <address>5</address>
          <description>Derivate width</description>
          <type>int</type>
          <default>5</default>
        </parameter>

        <parameter>
          <index>7</index>
          <address>7</address>
          <description>SNR Cutoff (dB)</description>
          <type>float</type>
          <default>18.0</default>
        </parameter>

      </algo>
    </algos>
  </registerDescription_RevC>
</config>